
<!DOCTYPE html>
<html>
<head>
    <title>PXPay Payload 自動測試頁面</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #result, #error, #status { margin-top: 20px; }
        #result { color: green; }
        #error { color: red; }
        #status { color: blue; }
        pre { background: #f4f4f4; padding: 10px; border: 1px solid #ccc; }
    </style>
    <script type="text/javascript">
        function setupWebViewJavascriptBridge(callback) {
            if (window.WebViewJavascriptBridge) {
                return callback(WebViewJavascriptBridge);
            }
            document.addEventListener(
                'WebViewJavascriptBridgeReady',
                function() {
                    callback(WebViewJavascriptBridge);
                },
                false
            );
        }

        window.onload = function() {
            document.getElementById('status').innerText = '⏳ 等待 WebViewJavascriptBridge 初始化...';

            setupWebViewJavascriptBridge(function(bridge) {
                document.getElementById('status').innerText = '✅ WebViewJavascriptBridge 已初始化';

                try {
                    bridge.callHandler('getPayload', null, function(response) {
                        if (response && typeof response === 'string') {
                            document.getElementById('result').innerText = '✅ Payload: ' + response;
                        } else {
                            document.getElementById('result').innerText = '⚠️ 已呼叫 getPayload，但回傳格式不正確。';
                            document.getElementById('error').innerText = '回傳內容：' + JSON.stringify(response);
                        }
                    });
                } catch (e) {
                    document.getElementById('result').innerText = '❌ 呼叫失敗';
                    document.getElementById('error').innerText = '錯誤訊息: ' + e.message;
                }
            });
        }
    </script>
</head>
<body>
    <h1>PXPay Payload 自動測試（依據規格文件）</h1>
    <p id="status">⏳ 初始化中...</p>
    <p id="result"></p>
    <p id="error"></p>
    <h3> 除錯資訊（請複製以下內容回報）</h3>
    <pre id="debugOutput"></pre>
</body>
</html>
